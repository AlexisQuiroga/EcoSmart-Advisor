{% extends "layout.html" %}

{% block title %}Inicio{% endblock %}

{% block content %}
<div class="row align-items-center mb-5">
    <div class="col-lg-6">
        <h1 class="display-4 fw-bold text-success">Asesoramiento Inteligente en Energías Renovables</h1>
        <p class="lead">EcoSmart Advisor te ayuda a elegir el sistema de energía renovable perfecto para tu hogar o negocio con análisis personalizados basados en IA.</p>
        <div class="mt-4">
            <a href="{{ url_for('diagnostico.diagnostico') }}" class="btn btn-success btn-lg me-2">
                <i class="fas fa-solar-panel me-2"></i>Comenzar Diagnóstico
            </a>
            <a href="{{ url_for('main.simulador') }}" class="btn btn-outline-success btn-lg">
                <i class="fas fa-calculator me-2"></i>Usar Simulador
            </a>
        </div>
    </div>


    
    <div class="col-lg-6 mt-4 mt-lg-0 p-0">
        <!-- Carrusel con todas las imágenes y el video (reconstruido completamente) -->
        <div id="carouselEnergiasRenovables" class="carousel slide rounded overflow-hidden shadow-sm" data-bs-ride="true">
            <!-- Indicadores (más transparentes) -->
            <div class="carousel-indicators" style="opacity: 0.3;">
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="0" class="active" aria-current="true"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="1"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="2"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="3"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="4"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="5"></button>
                <button type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide-to="6"></button>
            </div>
            
            <!-- Items del carrusel -->
            <div class="carousel-inner">
                <!-- Diapositiva 1: Energía Eólica -->
                <div class="carousel-item active">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('energia_eolica', {}).get('imagen_url', url_for('static', filename='images/carousel/energia_eolica.jpg')) }}" class="d-block w-100" alt="Energía Eólica">
                        <div class="position-absolute bottom-0 start-0 bg-{{ carousel_data.get('energia_eolica', {}).get('color', 'success') }} bg-opacity-75 text-white p-3 m-3 rounded" style="max-width: 300px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('energia_eolica', {}).get('titulo', 'Energía Eólica') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('energia_eolica', {}).get('texto_principal', 'La energía eólica aprovecha la fuerza del viento para generar electricidad limpia y renovable.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('energia_eolica', {}).get('dato_destacado', 'Un solo aerogenerador puede generar electricidad para cientos de hogares.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 2: Eficiencia Energética -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('eficiencia_energetica', {}).get('imagen_url', url_for('static', filename='images/carousel/eficiencia_energetica.jpg')) }}" class="d-block w-100" alt="Eficiencia Energética">
                        <div class="position-absolute bottom-0 end-0 bg-{{ carousel_data.get('eficiencia_energetica', {}).get('color', 'warning') }} bg-opacity-75 text-white p-3 m-3 rounded" style="max-width: 300px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('eficiencia_energetica', {}).get('titulo', 'Eficiencia Energética') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('eficiencia_energetica', {}).get('texto_principal', 'Mejora la eficiencia energética de tu hogar para reducir el consumo y maximizar el rendimiento de las energías renovables.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('eficiencia_energetica', {}).get('dato_destacado', 'La eficiencia energética puede reducir el consumo de energía hasta en un 30%.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 3: Energía Térmica -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('energia_termica', {}).get('imagen_url', url_for('static', filename='images/carousel/energia_termica.jpg')) }}" class="d-block w-100" alt="Energía Térmica">
                        <div class="position-absolute top-50 start-50 translate-middle bg-{{ carousel_data.get('energia_termica', {}).get('color', 'primary') }} bg-opacity-75 text-white p-3 rounded" style="max-width: 350px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('energia_termica', {}).get('titulo', 'Energía Solar Térmica') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('energia_termica', {}).get('texto_principal', 'Los sistemas de energía solar térmica aprovechan el calor del sol para generar agua caliente o calefacción.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('energia_termica', {}).get('dato_destacado', 'Un sistema solar térmico puede cubrir hasta el 70% de las necesidades de agua caliente de un hogar.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 4: Energía Solar -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('energia_solar', {}).get('imagen_url', url_for('static', filename='images/carousel/energia_solar.jpg')) }}" class="d-block w-100" alt="Energía Solar Fotovoltaica">
                        <div class="position-absolute top-0 end-0 bg-{{ carousel_data.get('energia_solar', {}).get('color', 'primary') }} bg-opacity-75 text-white p-3 m-3 rounded" style="max-width: 300px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('energia_solar', {}).get('titulo', 'Energía Solar Fotovoltaica') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('energia_solar', {}).get('texto_principal', 'Los paneles solares generan electricidad limpia y renovable directamente a partir de la luz solar.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('energia_solar', {}).get('dato_destacado', 'La energía solar es la fuente de energía renovable de mayor crecimiento a nivel mundial.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 5: Termotanque Solar -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('termotanque_solar', {}).get('imagen_url', url_for('static', filename='images/carousel/termotanque_solar.jpg')) }}" class="d-block w-100" alt="Termotanque Solar">
                        <div class="position-absolute bottom-0 start-0 bg-{{ carousel_data.get('termotanque_solar', {}).get('color', 'info') }} bg-opacity-75 text-white p-3 m-3 rounded" style="max-width: 300px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('termotanque_solar', {}).get('titulo', 'Termotanque Solar') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('termotanque_solar', {}).get('texto_principal', 'Los termotanques solares utilizan la energía del sol para calentar agua de manera eficiente y sostenible.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('termotanque_solar', {}).get('dato_destacado', 'Un termotanque solar puede calentar agua incluso en días parcialmente nublados.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 6: Futuro Renovable -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <img src="{{ carousel_data.get('futuro_renovables', {}).get('imagen_url', url_for('static', filename='images/carousel/futuro_renovable.jpg')) }}" class="d-block w-100" alt="Futuro Renovable">
                        <div class="position-absolute top-0 start-0 bg-{{ carousel_data.get('futuro_renovables', {}).get('color', 'danger') }} bg-opacity-75 text-white p-3 m-3 rounded" style="max-width: 300px;">
                            <h5 class="fs-6 fw-bold mb-1">{{ carousel_data.get('futuro_renovables', {}).get('titulo', 'Futuro de las Renovables') }}</h5>
                            <p class="mb-0 small">{{ carousel_data.get('futuro_renovables', {}).get('texto_principal', 'Las energías renovables son el pilar fundamental de un futuro energético sostenible y libre de emisiones.') }}</p>
                            <p class="mb-0 small mt-2">{{ carousel_data.get('futuro_renovables', {}).get('dato_destacado', 'Según proyecciones, más del 85% de la electricidad mundial será renovable para 2050.') }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diapositiva 7: Video de Aerogenerador -->
                <div class="carousel-item">
                    <div class="position-relative">
                        <video autoplay loop muted playsinline class="d-block w-100">
                            <source src="{{ url_for('static', filename='images/carousel/video generador eolico.mp4') }}" type="video/mp4">
                            Tu navegador no soporta videos HTML5.
                        </video>
                        <div class="position-absolute top-50 start-50 translate-middle bg-success bg-opacity-75 text-white p-3 rounded" style="max-width: 350px;">
                            <h5 class="fs-6 fw-bold mb-1">Funcionamiento del Aerogenerador</h5>
                            <p class="mb-0 small">Los aerogeneradores modernos producen electricidad limpia cuando el viento mueve sus palas a velocidades entre 3-25 m/s.</p>
                            <p class="mb-0 small mt-2">Una sola turbina puede evitar la emisión de hasta 1.500 toneladas de CO2 anualmente.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Controles del carrusel (ocultos por solicitud del usuario) -->
            <button class="carousel-control-prev d-none" type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Anterior</span>
            </button>
            <button class="carousel-control-next d-none" type="button" data-bs-target="#carouselEnergiasRenovables" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Siguiente</span>
            </button>
        </div>
    </div>


    
<section class="py-5 bg-white rounded-3 shadow-sm mb-5">
    <div class="container">
        <h2 class="text-center mb-4">Nuestras Herramientas</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <i class="fas fa-search-location fa-3x text-success"></i>
                        </div>
                        <h3 class="h5">Diagnóstico Inteligente</h3>
                        <p class="text-muted">Analiza tu ubicación, consumo y preferencias para recomendarte el sistema de energía renovable ideal.</p>
                        <a href="{{ url_for('diagnostico.diagnostico') }}" class="btn btn-outline-success btn-sm">Iniciar Diagnóstico</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <i class="fas fa-chart-line fa-3x text-primary"></i>
                        </div>
                        <h3 class="h5">Simulador Avanzado</h3>
                        <p class="text-muted">Simula diferentes escenarios y configuraciones para visualizar rendimiento y retorno de inversión.</p>
                        <a href="{{ url_for('main.simulador') }}" class="btn btn-outline-primary btn-sm">Probar Simulador</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body text-center p-4">
                        <div class="mb-3">
                            <i class="fas fa-robot fa-3x text-info"></i>
                        </div>
                        <h3 class="h5">Chatbot Educativo</h3>
                        <p class="text-muted">Resuelve tus dudas sobre energías renovables con nuestro asistente virtual basado en IA.</p>
                        <button onclick="abrirChatbot()" class="btn btn-outline-info btn-sm">Hacer Preguntas</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="mb-5">
    <h2 class="text-center mb-4">¿Por qué elegir energías renovables?</h2>
    <div class="row g-4">
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 border-0 bg-success bg-opacity-10">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-wallet text-success fa-2x me-3"></i>
                        <h3 class="h5 mb-0">Ahorro económico</h3>
                    </div>
                    <p class="mb-0">Reduce tu factura energética hasta un 70% y obtén retorno de inversión en 4-8 años.</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 border-0 bg-primary bg-opacity-10">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-tree text-primary fa-2x me-3"></i>
                        <h3 class="h5 mb-0">Impacto ambiental</h3>
                    </div>
                    <p class="mb-0">Reduce tu huella de carbono equivalente a plantar cientos de árboles cada año.</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 border-0 bg-warning bg-opacity-10">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-plug text-warning fa-2x me-3"></i>
                        <h3 class="h5 mb-0">Independencia</h3>
                    </div>
                    <p class="mb-0">Genera tu propia energía y reduce tu dependencia de la red eléctrica y combustibles fósiles.</p>
                </div>
            </div>
        </div>
        <div class="col-md-6 col-lg-3">
            <div class="card h-100 border-0 bg-info bg-opacity-10">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center mb-3">
                        <i class="fas fa-home text-info fa-2x me-3"></i>
                        <h3 class="h5 mb-0">Valor inmobiliario</h3>
                    </div>
                    <p class="mb-0">Aumenta el valor de tu propiedad con instalaciones modernas de energía renovable.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="bg-light p-5 rounded-3 shadow-sm mb-5">
    <div class="text-center mb-4">
        <h2>¿Listo para comenzar?</h2>
        <p class="lead">Obtén tu diagnóstico personalizado en menos de 5 minutos</p>
    </div>
    <div class="d-flex justify-content-center">
        <a href="{{ url_for('diagnostico.diagnostico') }}" class="btn btn-success btn-lg px-5">
            <i class="fas fa-lightbulb me-2"></i>Comenzar Ahora
        </a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // Función para inicializar el carrusel
    function initCarousel() {
        var carouselElement = document.getElementById('carouselEnergiasRenovables');
        
        if (!carouselElement) {
            console.error('No se encontró el elemento del carrusel');
            return;
        }
        
        // Destruir cualquier instancia previa para evitar conflictos
        var carouselInstance = bootstrap.Carousel.getInstance(carouselElement);
        if (carouselInstance) {
            carouselInstance.dispose();
        }
        
        // Crear nueva instancia con configuración óptima
        var carousel = new bootstrap.Carousel(carouselElement, {
            interval: 10000,       // Intervalo entre diapositivas (10 segundos)
            pause: false,          // No pausar al hover (puede causar problemas)
            wrap: true,            // Ciclo continuo
            touch: true,           // Soporte para touch
            keyboard: true,        // Soporte para teclado
            ride: true             // Iniciar automáticamente al cargar
        });
        
        console.log('Carrusel inicializado correctamente');
        
        // Detector para cambios de diapositiva
        carouselElement.addEventListener('slide.bs.carousel', function(e) {
            console.log('Cambiando a diapositiva: ' + e.to);
        });
        
        // Forzar transición a la primera diapositiva para activar el carrusel
        setTimeout(function() {
            carousel.to(0);
        }, 500);
    }
    
    // Inicializar cuando el DOM esté completamente cargado
    document.addEventListener('DOMContentLoaded', function() {
        initCarousel();
        
        // También inicializar cuando la ventana esté completamente cargada
        window.addEventListener('load', function() {
            initCarousel();
        });
        
        // Evento para activar el chatbot desde el botón de la sección de herramientas
        var botonActivarChatbot = document.getElementById('activarChatbot');
        if (botonActivarChatbot) {
            botonActivarChatbot.addEventListener('click', function() {
                // Usando la función global definida en layout.html
                if (typeof abrirChatbot === 'function') {
                    abrirChatbot();
                } else {
                    console.error('La función abrirChatbot no está disponible');
                }
            });
        }
    });
</script>
{% endblock %}